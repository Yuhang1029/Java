# Web 开发基础

**参考文档**

[第六章 HTTP协议](https://heavy_code_industry.gitee.io/code_heavy_industry/pro001-javaweb/lecture/chapter06/)

---

## 系统架构

常见的系统架构有两种，一种是 B/S 架构，一种是 C/S 架构。

### C/S 架构

C/S 架构即 Client / Server 模式（客户端 / 服务器），它需要安装特定的客户端软件例如从官网下载一个 QQ 安装到本地，它的优点很多，包括：

- 速度快（软件中的数据大部分都是集成到客户端软件当中的，很少量的数据从服务器端传送过来，所以 C/S 结构的系统速度快）
- 体验好（速度又快，界面又酷炫。）
- 服务器压力小（因为大量的数据都是集成在客户端软件当中，所以服务器只需要传送很少的数据量，当然服务器压力小。）
- 安全（因为大量的数据是集成在客户端软件当中的，并且客户端有很多个，服务器虽然只有一个，就算服务器那边地震了，火灾了，服务器受损了，问题也不大，因为大量的数据在多个客户端上有缓存，有存储，所以从这个方面来说，C/S 结构的系统比较安全。）

相比较优点，它的缺点也比较明显，包括升级维护比较麻烦，成本比较高，每一个客户端软件都需要升级，有一些软件不是那么容易安装的。

&emsp;

### B/S 架构

今天我们访问网站，使用 App 时，都是基于 Web 这种 Browser/Server 模式，简称 B/S 架构，它的特点是，客户端只需要浏览器，应用程序的逻辑和数据都存储在服务器端。浏览器只需要请求服务器，获取 Web 页面，并把 Web 页面展示给用户即可，不需要安装特定的客户端软件，用户操作极其方便。

Web 页面具有极强的交互性。由于 Web 页面是用 HTML 编写的，而 HTML 具备超强的表现力，并且，服务器端升级后，客户端无需任何部署就可以使用到新的版本，因此，B/S 架构升级非常容易。

常见的 Web 服务器包括：

&emsp;

## 网络通信基础

### 浏览器访问过程

Web 浏览器的访问过程包括：

- 第一步：用户输入网址（URL）`www.baidu.com`
- 第二步：域名解析器进行域名解析：`http://110.242.68.3:80/index.html`
- 第三步：浏览器软件在网络中搜索 110.242.68.3 这一台主机，直到找到这台主机。
- 第四步：定位 110.242.68.3 这台主机上的服务器软件，因为是 80 端口，可以很轻松的定位到 80 端口对应的服务器软件。
- 第五步：80 端口对应的服务器软件得知浏览器想要的资源名是 `index.html`。
- 第六步：服务器软件找到 `index.html` 文件，并且将 `index.html` 文件中的内容直接输出响应到浏览器上。
- 第七步：浏览器接收到来自服务器的代码（HTML CSS JS）
- 第八步：浏览器渲染，执行HTML CSS JS代码，展示效果。

一个端口代表一个软件（一个端口代表一个应用，一个端口仅代表一个服务）。一个计算机当中有很多软件，每一个软件启动之后都有一个端口号。在同一个计算机上，端口号具有唯一性。

&emsp;

### Web 服务器

假设 A 在某地办公，B 能否用自己的的电脑去访问 A 主机上的某张图片，显然是不可以的。我们太习惯通过 URL 去访问某一个资源，而一个资源如果没有 URL 的映射外界也很难去访问。Web 服务器，通俗的来说，就是把某个主机上的资源映射为一个 URL 供他人访问。

常见的 WEB 服务器包括：

- Tomcat（WEB 服务器）
- jetty（WEB 服务器）
- JBOSS（应用服务器）
- WebLogic（应用服务器）
- WebSphere（应用服务器）

应用服务器和 WEB 服务器的关系？

- 应用服务器实现了 JavaEE 的所有规范。(JavaEE 有13个不同的规范。)
- WEB 服务器只实现了 JavaEE 中的 Servlet + JSP 两个核心的规范。
- 通过这个讲解说明了，应用服务器是包含 WEB 服务器的。
- 用过 JBOSS 服务器的同学应该很清楚，JBOSS 中内嵌了一个 Tomcat 服务器。

&emsp;

## HTTP 协议

在 Web 应用中，浏览器请求一个 URL，服务器就把生成的 HTML 网页发送给浏览器，而浏览器和服务器之间的传输协议是 HTTP，所以：

- HTML 是一种用来定义网页的文本，会 HTML，就可以编写网页；

- HTTP 是在网络上传输 HTML 的协议，用于浏览器和服务器的通信。

&emsp;

### 请求与响应

对于浏览器来说，请求页面的流程如下：

1. 与服务器建立 TCP 连接；
2. 发送 HTTP 请求；
3. 收取 HTTP 响应，然后把网页在浏览器中显示出来。

浏览器发送的 HTTP 请求如下：

```http
GET / HTTP/1.1
Host: www.sina.com.cn
User-Agent: Mozilla/5.0 xxx
Accept: */*Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8
```

其中，第一行表示使用`GET`请求获取路径为`/`的资源，并使用`HTTP/1.1`协议，从第二行开始，每行都是以`Header: Value`形式表示的 HTTP 头，比较常用的 HTTP Header 包括：

- Host: 表示请求的主机名，因为一个服务器上可能运行着多个网站，因此，Host表示浏览器正在请求的域名；
- User-Agent: 标识客户端本身，例如Chrome浏览器的标识类似`Mozilla/5.0 ... Chrome/79`，IE浏览器的标识类似`Mozilla/5.0 (Windows NT ...) like Gecko`；
- Accept：表示浏览器能接收的资源类型，如`text/*`，`image/*`或者`*/*`表示所有；
- Accept-Language：表示浏览器偏好的语言，服务器可以据此返回不同语言的网页；
- Accept-Encoding：表示浏览器可以支持的压缩类型，例如`gzip, deflate, br`。

服务器的响应如下：

```http
HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 21932
Content-Encoding: gzip
Cache-Control: max-age=300

<html>...网页数据...
```

服务器响应的第一行总是版本号+空格+数字+空格+文本，数字表示响应代码，其中`2xx`表示成功，`3xx`表示重定向，`4xx`表示客户端引发的错误，`5xx`表示服务器端引发的错误。数字是给程序识别，文本则是给开发者调试使用的。常见的响应代码有：

- 200 OK：表示成功；
- 301 Moved Permanently：表示该URL已经永久重定向；
- 302 Found：表示该URL需要临时重定向；
- 304 Not Modified：表示该资源没有修改，客户端可以使用本地缓存的版本；
- 400 Bad Request：表示客户端发送了一个错误的请求，例如参数无效；
- 401 Unauthorized：表示客户端因为身份未验证而不允许访问该URL；
- 403 Forbidden：表示服务器因为权限问题拒绝了客户端的请求；
- 404 Not Found：表示客户端请求了一个不存在的资源；
- 500 Internal Server Error：表示服务器处理时内部出错，例如因为无法连接数据库；
- 503 Service Unavailable：表示服务器此刻暂时无法处理请求。

从第二行开始，服务器每一行均返回一个 HTTP 头。服务器经常返回的 HTTP Header 包括：

- Content-Type：表示该响应内容的类型，例如`text/html`，`image/jpeg`；
- Content-Length：表示该响应内容的长度（字节数）；
- Content-Encoding：表示该响应压缩算法，例如`gzip`；
- Cache-Control：指示客户端应如何缓存，例如`max-age=300`表示可以最多缓存300秒。
